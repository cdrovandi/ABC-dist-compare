function run_cvm_d1

load('d1.mat')

n = length(y);

% tune the ABC tolerance
for i=1:100000
    x = simulate_tsw(theta_test);
    dist(i) = cvm_stat_M(x,y,2);
end

eps = quantile(dist, 0.02);
%eps = 32.6149999999984;

cov_rw = [0.187152647995422,0.0236978627339534,0.0314076742557209,-0.0285636515069832,-0.272234911038495,0.420371690857662,-0.0990857672824724;0.0236978627339534,0.157992585000075,0.193421238855473,-0.00450375411473815,-0.0905270904039425,0.151511497841172,-0.0906704404915703;0.0314076742557209,0.193421238855473,0.246424806025630,-0.00563306583881126,-0.0678260125043725,0.117713769396971,-0.153918308287480;-0.0285636515069832,-0.00450375411473815,-0.00563306583881126,0.00440325759769466,0.0448497782565524,-0.0686556189857573,0.0149160371574920;-0.272234911038495,-0.0905270904039425,-0.0678260125043725,0.0448497782565524,0.848781451914655,-1.31104335488381,0.122226134920906;0.420371690857662,0.151511497841172,0.117713769396971,-0.0686556189857573,-1.31104335488381,4.70668464509795,0.430682407024742;-0.0990857672824724,-0.0906704404915703,-0.153918308287480,0.0149160371574920,0.122226134920906,0.430682407024742,1.95841322814228];

start = theta_test;

% define prior
prior.num_params = 7;
prior.p1 = [250 0.05 0.05 0 0 0 0];
prior.p2 = [400 0.5 0.35 50 7 50 7];
prior.sampler = @() [unifrnd(prior.p1,prior.p2)]; 
prior.pdf = @(theta) prod(exp(theta)./(1 + exp(theta)).^2);
prior.trans_f = @(theta) [log((theta - prior.p1)./(prior.p2 - theta))];
prior.trans_finv = @(theta) [(prior.p2.*exp(theta) + prior.p1)./(1 + exp(theta))];

[theta,dist] = bayes_toggle_abc_cvm(y,n,eps,1e7,cov_rw,prior,start);

save('results_mcmc_cvm_d1.mat','theta','dist','eps');


end
