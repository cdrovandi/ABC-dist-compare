function run_bsl

load('data_toggle.mat')

n = length(y);

%load('bsl_input_100.mat')
%numComp = bsl_input_100(run,2);
numComp = 3;

m = 50;

% TUNED
cov_rw = [0.00816849166392525,-0.00146568324253242,0.000314310421755270,-0.00138612420100922,-0.00680335868224198,0.000781156679894888,-0.0111799715428408;-0.00146568324253242,0.00455511521258687,0.00445853356620092,0.000207309365028800,-0.00409433982683362,-0.00572414737557973,-0.0126488910951841;0.000314310421755270,0.00445853356620092,0.00845573538655880,-0.000138221887300655,-0.00240059271292725,-0.000371748850085346,-0.00554470118524920;-0.00138612420100922,0.000207309365028800,-0.000138221887300655,0.000277423992173854,0.00180979462918786,-0.000637609256799265,0.00289265272588764;-0.00680335868224198,-0.00409433982683362,-0.00240059271292725,0.00180979462918786,0.205593248306951,-0.0930968190613733,0.368322835981844;0.000781156679894888,-0.00572414737557973,-0.000371748850085346,-0.000637609256799265,-0.0930968190613733,0.982990078868415,0.339510433185141;-0.0111799715428408,-0.0126488910951841,-0.00554470118524920,0.00289265272588764,0.368322835981844,0.339510433185141,1.11532313546578];

% define prior
prior.num_params = 7;
prior.p1 = [250 0.05 0.05 0 0 0 0];
prior.p2 = [400 0.5 0.35 50 7 50 7];
prior.sampler = @() [unifrnd(prior.p1,prior.p2)]; 
prior.pdf = @(theta) prod(exp(theta)./(1 + exp(theta)).^2);
prior.trans_f = @(theta) [log((theta - prior.p1)./(prior.p2 - theta))];
prior.trans_finv = @(theta) [(prior.p2.*exp(theta) + prior.p1)./(1 + exp(theta))];

tic;
[theta,dist] = bayes_toggle_bsl_aux(y,n,m,200000,cov_rw,prior,numComp);
finaltime=toc;

save('results_mcmc_bsl.mat','theta','dist','finaltime');


end
