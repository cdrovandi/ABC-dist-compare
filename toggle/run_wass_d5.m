function run_wass_d5

% run abc with Wass distance for dataset 5

load('d5.mat')

n = length(y);

% tune the ABC tolerance
for i=1:100000
    x = simulate_tsw(theta_test);
    dist(i) = Wass_stat_M(x,y,1);
end

eps = quantile(dist, 0.01);
%eps = 2.16793518151315;

start = theta_test;

cov_rw = [0.273179920178382,-0.120851050178501,0.0584726366590337,-0.0501446422176135,0.00598607762097654,-0.135685843474589,-0.0593352396915206;-0.120851050178501,0.105116711106511,0.00809925380023174,0.0212802298497112,-0.0142209387601483,0.0584332860179260,0.0191674626638958;0.0584726366590337,0.00809925380023174,0.0523519394675798,-0.0120660919639053,-0.00117602882142700,-0.0669999113681926,-0.0274124492035256;-0.0501446422176135,0.0212802298497112,-0.0120660919639053,0.00972678073032629,-0.000269602080873130,0.0310815517689338,0.0127238128844495;0.00598607762097654,-0.0142209387601483,-0.00117602882142700,-0.000269602080873130,0.0671768820678529,-0.180881190132328,0.197025895651030;-0.135685843474589,0.0584332860179260,-0.0669999113681926,0.0310815517689338,-0.180881190132328,2.86736930654091,0.187603618158185;-0.0593352396915206,0.0191674626638958,-0.0274124492035256,0.0127238128844495,0.197025895651030,0.187603618158185,1.92561429919385];

% define prior
prior.num_params = 7;
prior.p1 = [250 0.05 0.05 0 0 0 0];
prior.p2 = [400 0.5 0.35 50 7 50 7];
prior.sampler = @() [unifrnd(prior.p1,prior.p2)]; 
prior.pdf = @(theta) prod(exp(theta)./(1 + exp(theta)).^2);
prior.trans_f = @(theta) [log((theta - prior.p1)./(prior.p2 - theta))];
prior.trans_finv = @(theta) [(prior.p2.*exp(theta) + prior.p1)./(1 + exp(theta))];

[theta,dist] = bayes_toggle_abc_wass(y,n,eps,1e7,cov_rw,prior,start);

save('results_mcmc_wass_d5.mat','theta','dist','eps');


end
