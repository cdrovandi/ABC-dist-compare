function run_bsl_d4

% run bsl with summary statistics for dataset 4

load('d4.mat')

n = length(y);

numComp = 3;

m = 100;

% TUNED
cov_rw = [0.0810504763560905,-0.0159335025409006,-0.00877448085175112,-0.00909003395731233,-0.000825159242950047,-0.0500076262447724,-0.0259827541249553;-0.0159335025409006,0.0259916564244401,0.0281048878699348,0.00177084006666204,0.000265109445613706,-0.0209287418903656,-0.0247123996633017;-0.00877448085175112,0.0281048878699348,0.0333107438157767,0.000976694153086719,0.00164596264575022,-0.0429986190102019,-0.0426560956495109;-0.00909003395731233,0.00177084006666204,0.000976694153086719,0.00105115917226612,0.000269980668686311,0.00430051905559865,0.00293007283375699;-0.000825159242950047,0.000265109445613706,0.00164596264575022,0.000269980668686311,0.0178702439149982,-0.113854394418041,0.0813068900007340;-0.0500076262447724,-0.0209287418903656,-0.0429986190102019,0.00430051905559865,-0.113854394418041,2.28818096087720,0.399298575634783;-0.0259827541249553,-0.0247123996633017,-0.0426560956495109,0.00293007283375699,0.0813068900007340,0.399298575634783,2.18897981114236];

% define prior
prior.num_params = 7;
prior.p1 = [250 0.05 0.05 0 0 0 0];
prior.p2 = [400 0.5 0.35 50 7 50 7];
prior.sampler = @() [unifrnd(prior.p1,prior.p2)]; 
prior.pdf = @(theta) prod(exp(theta)./(1 + exp(theta)).^2);
prior.trans_f = @(theta) [log((theta - prior.p1)./(prior.p2 - theta))];
prior.trans_finv = @(theta) [(prior.p2.*exp(theta) + prior.p1)./(1 + exp(theta))];

tic;
% include initialisation of mcmc chain
[theta,dist] = bayes_toggle_bsl_aux_start(y,n,m,200000,cov_rw,prior,numComp,theta_test);
finaltime=toc;

save('results_mcmc_bsl_d4.mat','theta','dist','finaltime');


end
