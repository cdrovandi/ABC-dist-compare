function run_wass_d1


load('d1.mat')

n = length(y);

% tune the ABC tolerance
for i=1:100000
    x = simulate_tsw(theta_test);
    dist(i) = Wass_stat_M(x,y,1);
end

eps = quantile(dist, 0.02);
%eps = 2.16793518151315;

start = theta_test;

cov_rw = [0.860579702086838,0.195521677952837,0.624585789566269,-0.103588696466505,0.0613124265711967,0.00303643318938481,0.100183297634275;0.195521677952837,0.277164611544519,0.596124847981236,-0.0161039697081973,0.0582899615200944,0.0122678901110705,0.460853556813212;0.624585789566269,0.596124847981236,1.49884466635368,-0.0628509241320395,0.123136815553066,-0.151323622616332,0.780487889908636;-0.103588696466505,-0.0161039697081973,-0.0628509241320395,0.0133504433660699,-0.00567431457784418,-0.00170961316167794,-0.0143836509430653;0.0613124265711967,0.0582899615200944,0.123136815553066,-0.00567431457784418,0.0297733412064188,0.00468047880029039,0.234048900895869;0.00303643318938481,0.0122678901110705,-0.151323622616332,-0.00170961316167794,0.00468047880029039,2.23136850090599,0.909903310339018;0.100183297634275,0.460853556813212,0.780487889908636,-0.0143836509430653,0.234048900895869,0.909903310339018,3.73298900623696];

% define prior
prior.num_params = 7;
prior.p1 = [250 0.05 0.05 0 0 0 0];
prior.p2 = [400 0.5 0.35 50 7 50 7];
prior.sampler = @() [unifrnd(prior.p1,prior.p2)]; 
prior.pdf = @(theta) prod(exp(theta)./(1 + exp(theta)).^2);
prior.trans_f = @(theta) [log((theta - prior.p1)./(prior.p2 - theta))];
prior.trans_finv = @(theta) [(prior.p2.*exp(theta) + prior.p1)./(1 + exp(theta))];

[theta,dist] = bayes_toggle_abc_wass(y,n,eps,1e7,cov_rw,prior,start);

save('results_mcmc_wass_d1.mat','theta','dist','eps');


end
