function run_wass_d3

% run abc with Wass distance for dataset 3

load('d3.mat')

n = length(y);

% tune the ABC tolerance
for i=1:100000
    x = simulate_tsw(theta_test);
    dist(i) = Wass_stat_M(x,y,1);
end

eps = quantile(dist, 0.02);
%eps = 2.16793518151315;

start = theta_test;

cov_rw = [0.00146347427313138,-0.000643184147948466,1.89940331904727e-05,-0.000390240908567584,-0.00451688540671918,0.00866930993937633,0.00124616047746604;-0.000643184147948466,0.00349964866996001,0.00400347745650728,0.000573578379936151,0.0268964690348259,-0.00519883356017717,0.00221592315723040;1.89940331904727e-05,0.00400347745650728,0.0118310586462246,0.000506631723782571,0.0392948506721633,-0.0358175193458602,-0.00678737645713641;-0.000390240908567584,0.000573578379936151,0.000506631723782571,0.000239775441447848,0.00334833703134394,-0.00220547037124342,0.000416131697498864;-0.00451688540671918,0.0268964690348259,0.0392948506721633,0.00334833703134394,0.758615384535553,-0.303069940488582,0.0576785402409745;0.00866930993937633,-0.00519883356017717,-0.0358175193458602,-0.00220547037124342,-0.303069940488582,1.61236213215195,0.331628293827664;0.00124616047746604,0.00221592315723040,-0.00678737645713641,0.000416131697498864,0.0576785402409745,0.331628293827664,0.124555844418041];

% define prior
prior.num_params = 7;
prior.p1 = [250 0.05 0.05 0 0 0 0];
prior.p2 = [400 0.5 0.35 50 7 50 7];
prior.sampler = @() [unifrnd(prior.p1,prior.p2)]; 
prior.pdf = @(theta) prod(exp(theta)./(1 + exp(theta)).^2);
prior.trans_f = @(theta) [log((theta - prior.p1)./(prior.p2 - theta))];
prior.trans_finv = @(theta) [(prior.p2.*exp(theta) + prior.p1)./(1 + exp(theta))];

[theta,dist] = bayes_toggle_abc_wass(y,n,eps,1e7,cov_rw,prior,start);

save('results_mcmc_wass_d3.mat','theta','dist','eps');


end
