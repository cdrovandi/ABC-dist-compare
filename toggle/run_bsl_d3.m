function run_bsl_d3

load('d3.mat')

n = length(y);

%load('bsl_input_100.mat')
%numComp = bsl_input_100(run,2);
numComp = 3;

m = 100;

% TUNED
cov_rw = [0.000960708217621883,-0.000187738848095608,-2.85501205028959e-05,-8.65232858368497e-05,0.000210068675908632,-0.00206526473882415,0.000143602527386219;-0.000187738848095608,0.00250255466282028,0.00599408154764106,-4.41374860302027e-05,0.000406737574140054,0.0167812567316716,0.00355095986333635;-2.85501205028959e-05,0.00599408154764106,0.790909105943371,9.56193705663872e-05,0.134976815455949,0.0867394042181005,0.0272528510257547;-8.65232858368497e-05,-4.41374860302027e-05,9.56193705663872e-05,0.000527284378957055,0.00731249017970622,-0.000340223305190926,0.000175859190983684;0.000210068675908632,0.000406737574140054,0.134976815455949,0.00731249017970622,1.13239961607290,0.0711766441460513,0.109605404007335;-0.00206526473882415,0.0167812567316716,0.0867394042181005,-0.000340223305190926,0.0711766441460513,2.39428744197148,0.453140176062943;0.000143602527386219,0.00355095986333635,0.0272528510257547,0.000175859190983684,0.109605404007335,0.453140176062943,0.123312811006355];

% define prior
prior.num_params = 7;
prior.p1 = [250 0.05 0.05 0 0 0 0];
prior.p2 = [400 0.5 0.35 50 7 50 7];
prior.sampler = @() [unifrnd(prior.p1,prior.p2)]; 
prior.pdf = @(theta) prod(exp(theta)./(1 + exp(theta)).^2);
prior.trans_f = @(theta) [log((theta - prior.p1)./(prior.p2 - theta))];
prior.trans_finv = @(theta) [(prior.p2.*exp(theta) + prior.p1)./(1 + exp(theta))];

tic;
% include initialisation of mcmc chain
[theta,dist] = bayes_toggle_bsl_aux_start(y,n,m,200000,cov_rw,prior,numComp,theta_test);
finaltime=toc;

save('results_mcmc_bsl_d3.mat','theta','dist','finaltime');


end
